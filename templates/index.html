<!-- START OF index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lost & Found</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon.png') }}">
<link rel="apple-touch-icon" href="{{ url_for('static', filename='favicon.png') }}">
  <style>
      :root {
    --bs-primary: rgba(0,43,83,1);
    --bs-primary-rgb: 0,43,83;
  }
body {
  font-family: "Gill Sans", "Gill Sans MT", Calibri, "Trebuchet MS", sans-serif;
}

h1, h2, h3, h4, h5, h6 {
  font-family: "Minion Pro", "Georgia", serif;
}


    .hero {
      position: relative;
      background-color: rgba(0,43,83,1);
      color: white;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      overflow: hidden;
      flex-direction: column;
      padding: 0 20px;
    }


    .hero img.logo {
      max-height: 160px;
      margin-bottom: 20px;
      z-index: 2;
    }
    .hero::before {
      content: "";
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.55);
      z-index: 1;
    }
    .hero > .container {
      position: relative;
      z-index: 2;
    }
    .hero h1 {
      font-size: 3rem;
      font-weight: 700;
    }
    .hero p {
      font-size: 1.25rem;
    }

    .card {
      border: none;
      border-radius: 1rem;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease-in-out;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .card:hover {
      transform: translateY(-5px);
    }

    .card-img-top {
      height: 180px;
      object-fit: cover;
      border-top-left-radius: 1rem;
      border-top-right-radius: 1rem;
    }

    .card-body {
      padding: 1.25rem;
      display: flex;
      flex-direction: column;
    }

    .card-title {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0;
    }

    .card-text.truncate-description {
      font-size: 0.95rem;
      color: #555;
      line-height: 1.4;
      margin-bottom: 0.75rem;
      min-height: 60px;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
    }

    .badge {
      font-size: 0.8rem;
      padding: 0.35em 0.65em;
      border-radius: 0.5rem;
    }

    .btn-sm {
      font-size: 0.85rem;
      padding: 0.45rem 0.75rem;
      border-radius: 0.4rem;
    }

    .mybtn {
      background-color: rgba(0,43,83,0.75);
      color: white;
      padding: 10px 25px;
    }

    .mybtn:hover {
      background-color: rgba(0,43,83,1);
    }
      .badge-primary,
  .btn-outline-primary {
    border-color: rgba(0,43,83,1);
    color: rgba(0,43,83,1);
  }

  .btn-outline-primary:hover {
    background-color: rgba(0,43,83,1);
    color: white;
  }

  .bg-primary {
    background-color: rgba(0,43,83,1) !important;
  }

  .text-primary {
    color: rgba(0,43,83,1) !important;
  }

  .btn-primary {
    background-color: rgba(0,43,83,1) !important;
    border-color: rgba(0,43,83,1) !important;
  }

  .btn-primary:hover {
    background-color: #001d3d !important;
    border-color: #001d3d !important;
  }
    .bg-lost {
  background-color: #ff6b6b !important;
  color: white !important;
}

.bg-returned {
  background-color: #4ecdc4 !important;
  color: white !important;
}

  </style>
</head>

<body class="bg-light">
  {% include 'nav.html' %}

  <section class="hero text-white"  id="vanta-hero">
    <div class="container">
      <img src="{{ url_for('static', filename='dolphin_logo.webp') }}" alt="Logo" class="logo">
      <h1 class="mb-3">Lost & Found</h1>
      <p class="mb-4">Chadwick International School</p>
      <a href="{{ url_for('login') }}" class="btn mybtn">Get Started</a>
    </div>
  </section>

  <div class="container py-5">
    <div class="mb-4 d-flex flex-wrap justify-content-between align-items-center">
      <h2 class="mb-3"><i class="bi bi-box-seam-fill me-2"></i>All Items</h2>
      <div class="d-flex flex-wrap gap-2">
        <input type="text" id="searchInput" class="form-control" placeholder="Search by title or reporter" />
        <select id="statusFilter" class="form-select">
          <option value="all">All</option>
          <option value="lost">Lost</option>
          <option value="returned">Returned</option>
        </select>
      </div>
    </div>

    <div class="row grid" id="itemsContainer">
      {% for item in items %}
      <div class="col-md-4 mb-4 grid-item"
           data-status="{{ 'returned' if item.returned else 'lost' }}"
           data-title="{{ item.title|lower }}"
           data-owner="{{ item.owner|lower }}">
        <div class="card {% if item.returned %}border-success{% endif %}">
          <img src="{{ url_for('static', filename='uploads/' + item.image) }}" class="card-img-top" alt="Item Image">

          <div class="card-body d-flex flex-column">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h5 class="card-title">{{ item.title }}</h5>
<span class="badge {% if item.returned %}bg-returned{% else %}bg-lost{% endif %}">
                {% if item.returned %}
                  <i class="bi bi-check-circle-fill me-1"></i>Returned
                {% else %}
                  <i class="bi bi-hourglass-split me-1"></i>Lost
                {% endif %}
              </span>
            </div>

            <p class="card-text truncate-description">{{ item.description[:80] }}...</p>
            <div class="d-flex justify-content-between align-items-center mt-auto flex-wrap gap-2">
              <p class="text-muted small mb-0">
                {% if item.returned %}Originally{% else %}Reported{% endif %} by {{ item.owner }}
              </p>
              <div class="d-flex gap-2">
                <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#modal{{ loop.index }}">
                  <i class="bi bi-info-circle me-1"></i> Details
                </button>
                {% if not item.returned and 'username' in session and session['username'] == item.owner %}
                  <a href="{{ url_for('mark_returned', item_id=loop.index0) }}" class="btn btn-outline-success btn-sm">
                    <i class="bi bi-check-circle me-1"></i> Mark as Returned
                  </a>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="modal{{ loop.index }}" tabindex="-1" aria-labelledby="modalLabel{{ loop.index }}" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modalLabel{{ loop.index }}">{{ item.title }}</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
<div class="modal-body">
  <img src="{{ url_for('static', filename='uploads/' + item.image) }}" class="img-fluid rounded mb-3 shadow-sm" alt="Item Image">

  <div class="mb-3">
    <h6 class="fw-bold text-primary">Description</h6>
    <p>{{ item.description }}</p>
  </div>

  <div class="mb-3">
    <h6 class="fw-bold text-primary">Owner</h6>
    <p class="mb-1"><i class="bi bi-person-circle me-1"></i>{{ item.owner }}</p>
  </div>

  <div class="mb-4">
    <h6 class="fw-bold text-primary">Status</h6>
<span class="badge px-3 py-2 {% if item.returned %}bg-returned{% else %}bg-lost{% endif %}">
      {% if item.returned %}Returned{% else %}Lost{% endif %}
    </span>
  </div>

          {% if not item.returned and session.get('username') and session['username'] != item.owner %}
          <div class="border-top pt-3 mt-4">
            <h5 class="fw-semibold mb-3 text-primary"><i class="bi bi-envelope-paper-fill me-1"></i>Contact the Owner</h5>

            <form action="{{ url_for('contact_owner') }}" method="post">
              <input type="hidden" name="owner" value="{{ item.owner }}">
              <input type="hidden" name="item_title" value="{{ item.title }}">

              <div class="mb-2">
                <label for="name-{{ loop.index }}" class="form-label">Your Name</label>
                <input type="text" name="finder_name" class="form-control shadow-sm" id="name-{{ loop.index }}" required>
              </div>
              <div class="mb-2">
                <label for="grade-{{ loop.index }}" class="form-label">Your Grade</label>
                <input type="text" name="finder_grade" class="form-control shadow-sm" id="grade-{{ loop.index }}" required>
              </div>
              <div class="mb-2">
                <label for="contact-{{ loop.index }}" class="form-label">Contact Info (Email or Phone)</label>
                <input type="text" name="finder_contact" class="form-control shadow-sm" id="contact-{{ loop.index }}" required>
              </div>
              <div class="mb-3">
                <label for="message-{{ loop.index }}" class="form-label">Message</label>
                <textarea name="finder_message" class="form-control shadow-sm" id="message-{{ loop.index }}" rows="3" required></textarea>
              </div>

              <button type="submit" class="btn btn-primary w-100">
                <i class="bi bi-send-fill me-1"></i> Send Message
              </button>
            </form>
          </div>
          {% endif %}
        </div>

          </div>
        </div>
      </div>
      {% endfor %}
    </div>



    <!-- Success Modal -->
<div class="modal fade" id="messageSuccessModal" tabindex="-1" aria-labelledby="messageSuccessLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content shadow">
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title" id="messageSuccessLabel">Message Sent</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        <p>Your message has been successfully sent to the item owner.</p>
        <p>Please wait for them to reach out to you using your contact info.</p>
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-success px-4" data-bs-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js"></script>
  <script>
    const iso = new Isotope('.grid', {
      itemSelector: '.grid-item',
      layoutMode: 'fitRows',
    });

    const searchInput = document.getElementById("searchInput");
    const statusFilter = document.getElementById("statusFilter");

    function filterIsotope() {
      const query = searchInput.value.toLowerCase();
      const status = statusFilter.value;

      iso.arrange({
        filter: function (itemElem) {
          const title = itemElem.getAttribute('data-title');
          const owner = itemElem.getAttribute('data-owner');
          const itemStatus = itemElem.getAttribute('data-status');

          const matchesSearch = title.includes(query) || owner.includes(query);
          const matchesStatus = status === "all" || itemStatus === status;

          return matchesSearch && matchesStatus;
        }
      });
    }

    searchInput.addEventListener("input", filterIsotope);
    statusFilter.addEventListener("change", filterIsotope);
  </script>

{% with messages = get_flashed_messages() %}
  {% if 'message_sent' in messages %}
    <script>
      window.addEventListener('load', function() {
        const successModal = new bootstrap.Modal(document.getElementById('messageSuccessModal'));
        successModal.show();
      });
    </script>
  {% endif %}
{% endwith %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.waves.min.js"></script>

<script>
  VANTA.WAVES({
    el: "#vanta-hero",
    mouseControls: true,
    touchControls: true,
    minHeight: 200.00,
    minWidth: 200.00,
    scale: 1.0,
    scaleMobile: 1.0,
    color: 0x002b53,
    shininess: 30.0,
    waveHeight: 20.0,
    waveSpeed: 0.6,
    zoom: 0.85
  })
</script>

</body>
</html>
<!-- END OF index.html -->
